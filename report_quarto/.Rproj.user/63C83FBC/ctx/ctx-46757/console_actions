{
    "type": [
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        0,
        0,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        2,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        3,
        2
    ],
    "data": [
        "\nR version 4.4.2 (2024-10-31 ucrt) -- \"Pile of Leaves\"\nCopyright (C) 2024 The R Foundation for Statistical Computing\nPlatform: x86_64-w64-mingw32/x64\n\nR -- —ç—Ç–æ —Å–≤–æ–±–æ–¥–Ω–æ–µ –ü–û, –∏ –æ–Ω–æ –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –±–µ–∑–æ –≤—Å—è–∫–∏—Ö –≥–∞—Ä–∞–Ω—Ç–∏–π.\n–í—ã –≤–æ–ª—å–Ω—ã —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å –µ–≥–æ –ø—Ä–∏ —Å–æ–±–ª—é–¥–µ–Ω–∏–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —É—Å–ª–æ–≤–∏–π.\n–í–≤–µ–¥–∏—Ç–µ 'license()' –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.\n\nR -- —ç—Ç–æ –ø—Ä–æ–µ–∫—Ç, ",
        "–≤ –∫–æ—Ç–æ—Ä–æ–º —Å–æ—Ç—Ä—É–¥–Ω–∏—á–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.\n–í–≤–µ–¥–∏—Ç–µ 'contributors()' –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏\n'citation()' –¥–ª—è –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏—è —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è R –∏ –µ–≥–æ –ø–∞–∫–µ—Ç–æ–≤\n–≤ –ø—É–±–ª–∏–∫–∞—Ü–∏—è—Ö.\n\n–í–≤–µ–¥–∏—Ç–µ 'demo()' –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º, 'help()' -- –¥–ª—è\n–ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø—Ä–∞–≤–∫–∏, 'help.start()' --",
        " –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–ø—Ä–∞–≤–∫–µ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä.\n–í–≤–µ–¥–∏—Ç–µ 'q()', —á—Ç–æ–±—ã –≤—ã–π—Ç–∏ –∏–∑ R.\n\n",
        "> ",
        "#| label: –ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞–∫–µ—Ç–æ–≤",
        "> ",
        "#| warning: false",
        "> ",
        "library(tidyverse)",
        "> ",
        "library(readxl)",
        "> ",
        "library(VIM) #–¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤",
        "> ",
        "library(rvest) #–¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –∏–∑ –≤–µ–±–∞",
        "> ",
        "library(pracma) #–¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —Å–∫–æ–ª—å–∑—è—â–µ–π —Å—Ä–µ–¥–Ω–µ–π",
        "> ",
        "#| label: reading_XXI",
        "> ",
        "#| warning: false",
        "> ",
        "> ",
        "reading_XXI <- function(name_of_df){",
        "+ ",
        "  result <- read_excel(name_of_df) |> ",
        "+ ",
        "    select(1,2,28) |> ",
        "+ ",
        "    rename(Local_time = 1) |> ",
        "+ ",
        "    mutate(Local_time = as_datetime(Local_time, format=\"%d.%m.%Y %R\")) |> ",
        "+ ",
        "    mutate(Year = year(Local_time),",
        "+ ",
        "           Month = month(Local_time),",
        "+ ",
        "           Day = mday(Local_time)) |> ",
        "+ ",
        "    rename(Sn = \"E'\",",
        "+ ",
        "           Tavg = \"T\") |>",
        "+ ",
        "    group_by(Year, Month, Day) |> ",
        "+ ",
        "    summarise(Sn = as.factor(str_flatten(Sn, \", \", na.rm = T)),",
        "+ ",
        "              Tavg = mean(Tavg, na.rm=T)) |> ",
        "+ ",
        "    arrange(Year, Month, Day) |> ",
        "+ ",
        "    mutate(Station = str_match(name_of_df, \"station/(.*?).xls\")[2])",
        "+ ",
        "  return(result)",
        "+ ",
        "}",
        "> ",
        "#| label: –û—Å—Ç–∞–≤—à–∏–µ—Å—è —Ñ—É–Ω–∫—Ü–∏–∏",
        "> ",
        "#| warning: false",
        "> ",
        "> ",
        "reading_XX <- function(x){read_table2(x, col_names = F)}",
        "> ",
        "> ",
        "parsing_html_table <- function(http){",
        "+ ",
        "  df <- read_html(http)",
        "+ ",
        "  year <- df |> ",
        "+ ",
        "    html_element(\".chronicle-table-left-column\") |> ",
        "+ ",
        "    html_table() |> ",
        "+ ",
        "    slice(-1)",
        "+ ",
        "  temper <- df |> ",
        "+ ",
        "    html_element(\".chronicle-table\") |> ",
        "+ ",
        "    html_table() |> ",
        "+ ",
        "    slice(-1)",
        "+ ",
        "  ",
        "+ ",
        "  result <- cbind(year, temper)",
        "+ ",
        "  colnames(result) <- c(\"Year\", c(1:12), \"annualy\")",
        "+ ",
        "  result <- result |> ",
        "+ ",
        "    select(-annualy) |> ",
        "+ ",
        "    pivot_longer(-Year, values_to = \"Tavg\", names_to = \"Month\") |> ",
        "+ ",
        "    filter(Year %in% c(1961:2004) | (Year == 2005 & Month==1)) |> ",
        "+ ",
        "    mutate_at(c(1:3), .funs=as.numeric)",
        "+ ",
        "  return(result)",
        "+ ",
        "}",
        "> ",
        "> ",
        "> ",
        "std <- function(x){ sd(x)/sqrt(length(x)) } # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ/–∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å –∏–∑ —á–∏—Å–ª–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π",
        "> ",
        "# exponential_smooth <- function(x) { es(x, model=\"AAdN\",h=8,holdout=FALSE,cfType=\"MSE\")$fitted}",
        "> ",
        "means_smooth <- function(x, n) {",
        "+ ",
        "  pracma::movavg(x, n=10, type=c(\"s\"))",
        "+ ",
        "}",
        "> ",
        "> ",
        "> ",
        "#| label: –ò–º–ø–æ—Ä—Ç",
        "> ",
        "#| warning: false",
        "> ",
        "> ",
        "# –î–∞–Ω–Ω—ã–µ 2005-2023 (6 —Å—Ç–∞–Ω—Ü–∏–π(–±–µ–∑ –±–∞—Ö—Ç—ã)) —Å—É—Ç–æ—á–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ ----------------------------------------------",
        "> ",
        "paths <- list.files(\"initial_data/climate/2005_2023_seven_station\", pattern = \"[.]xls$\", full.names = TRUE)",
        "> ",
        "> ",
        "six_station_2005_2023 <- paths |>",
        "+ ",
        "  map_dfr(reading_XXI)",
        "> ",
        "rm(reading_XXI, paths)",
        "> ",
        "aggr(six_station_2005_2023, prop = F, numbers = T) #–æ—Ç–ª–∏—á–Ω–æ, –ø—Ä–æ–ø—É—Å–∫–æ–≤ –Ω–µ—Ç",
        "> ",
        "six_station_2005_2023_monthly <- six_station_2005_2023 |> ",
        "+ ",
        "  group_by(Station, Year, Month) |> ",
        "+ ",
        "  summarise(Tavg = mean(Tavg))",
        "> ",
        "View(six_station_2005_2023_monthly)",
        "> ",
        "levels(factor(six_station_2005_2023_monthly$Station))",
        "[1] \"bor\"            \"igarka\"         \"turukhansk\"     \"verkhneimbatsk\"\n[5] \"vorogovo\"       \"yartsevo\"      \n",
        "> ",
        "paths <- list.files(\"initial_data/climate/monthly_all_station/\", pattern = \"[.]txt$\", full.names = TRUE) # –ü—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–ª–∏ –≤—Å–µ —Ñ–∞–π–ª—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏",
        "> ",
        "four_station_obninsk <- paths |>",
        "+ ",
        "  map(reading_XX) |>",
        "+ ",
        "  list_rbind() |> ",
        "+ ",
        "  rename(Station = X1) |> ",
        "+ ",
        "  mutate(Station = case_when(",
        "+ ",
        "    Station == \"23274\" ~\"igarka\",",
        "+ ",
        "    Station == \"23678\" ~ \"verkhneimbatsk\",",
        "+ ",
        "    Station == \"23472\" ~ \"turukhansk\",",
        "+ ",
        "    .default = \"bor\"))",
        "> ",
        "colnames(four_station_obninsk) <- c(\"Station\", \"Year\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\",\"8\", \"9\", \"10\", \"11\", \"12\")",
        "> ",
        "> ",
        "rm(paths)",
        "> ",
        "four_station_obninsk <- four_station_obninsk |> ",
        "+ ",
        "  pivot_longer(-c(Station, Year), names_to = \"Month\", values_to = \"Tavg\") |> ",
        "+ ",
        "  mutate(Month = as.numeric(Month)) |> ",
        "+ ",
        "  filter(Year %in% c(1961:2004) | (Year == 2005 & Month==1))",
        "> ",
        "View(four_station_obninsk)",
        "> ",
        "#| label: —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –û–±–Ω–∏–Ω—Å–∫ (–º–µ—Å—è—á–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ) 4 —Å—Ç–∞–Ω—Ü–∏–∏ ",
        "> ",
        "#| warning: false",
        "> ",
        "> ",
        "paths <- list.files(\"initial_data/climate/monthly_all_station/\", pattern = \"[.]txt$\", full.names = TRUE) # –ü—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–ª–∏ –≤—Å–µ —Ñ–∞–π–ª—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏",
        "> ",
        "four_station_obninsk <- paths |>",
        "+ ",
        "  map(reading_XX) |>",
        "+ ",
        "  list_rbind() |> ",
        "+ ",
        "  rename(Station = X1) |> ",
        "+ ",
        "  mutate(Station = case_when(",
        "+ ",
        "    Station == \"23274\" ~\"igarka\",",
        "+ ",
        "    Station == \"23678\" ~ \"verkhneimbatsk\",",
        "+ ",
        "    Station == \"23472\" ~ \"turukhansk\",",
        "+ ",
        "    .default = \"bor\"))",
        "> ",
        "colnames(four_station_obninsk) <- c(\"Station\", \"Year\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\",\"8\", \"9\", \"10\", \"11\", \"12\")",
        "> ",
        "> ",
        "rm(paths)",
        "> ",
        "> ",
        "four_station_obninsk <- four_station_obninsk |> ",
        "+ ",
        "  pivot_longer(-c(Station, Year), names_to = \"Month\", values_to = \"Tavg\") |> ",
        "+ ",
        "  mutate(Month = as.numeric(Month)) |> ",
        "+ ",
        "  filter(Year %in% c(1961:2004) | (Year == 2005 & Month==1))",
        "> ",
        "> ",
        "#| label: –í–æ—Ä–æ–≥–æ–≤–æ –∏ —è—Ä—Ü–µ–≤–æ (–∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞)",
        "> ",
        "#| warning: false",
        "> ",
        "> ",
        "#  ----------------------------------------",
        "> ",
        "vorogovo <- parsing_html_table(\"http://www.pogodaiklimat.ru/history/23973.htm\") |>",
        "+ ",
        "  mutate(Station = \"vorogovo\")",
        "> ",
        "yartsevo <- parsing_html_table(\"http://www.pogodaiklimat.ru/history/23987.htm\") |> ",
        "+ ",
        "  mutate(Station = \"yartsevo\")",
        "> ",
        "#| label: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö",
        "> ",
        "#| warning: false",
        "> ",
        "> ",
        "# 6 —Å—Ç–∞–Ω—Ü–∏–π (–∫—Ä–æ–º–µ –ë–∞—Ö—Ç—ã). –î–∞–Ω–Ω—ã—Ö –æ–± –æ—Å–∞–¥–∫–∞—Ö –∏ –≥–ª—É–±–∏–Ω–µ —Å–Ω–µ–≥–∞ –Ω–µ—Ç.",
        "> ",
        "six_station <- rbind(six_station_2005_2023_monthly, four_station_obninsk, vorogovo, yartsevo) |> ",
        "+ ",
        "  arrange(Station, Year, Month) |> ",
        "+ ",
        "  filter(Year %in% c(1961:2022) | (Year %in% c(1961:2023) & Month <7)) |> ",
        "+ ",
        "  mutate(Pr = NA, Sn = NA) |> ",
        "+ ",
        "  select(Station, Year, Month, Tavg, Pr, Sn)",
        "> ",
        "> ",
        "# –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Ä–∞–Ω–µ–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–∞—Ö—Ç—ã",
        "> ",
        "bakhta_monthly <- read_csv2(\"initial_data/climate/cleaned/Bakhta_monthly_1966-1976_replaced_by_average_Bor_Verkhn.csv\") |> ",
        "+ ",
        "  mutate(Station = \"bakhta\") |>  ",
        "+ ",
        "  select(Station, Year, Month, Tavg, Pr, Sn)",
        "> ",
        "> ",
        "# –¥–∞–Ω–Ω—ã–µ –ø–æ –≤—Å–µ–º –º–µ—Ç–µ–æ—Å—Ç–∞–Ω—Ü–∏—è–º",
        "> ",
        "all_station <- rbind(six_station, bakhta_monthly) |> ",
        "+ ",
        "  arrange(Station, Year, Month)",
        "> ",
        "> ",
        "> ",
        "average_temp_by_7_station <- all_station |> ",
        "+ ",
        "  group_by(Year, Month) |> ",
        "+ ",
        "  summarise(Tavg = mean(Tavg)) |> ",
        "+ ",
        "  mutate(Station = \"average_by_all_station\")",
        "> ",
        "> ",
        "# –¥–∞–Ω–Ω—ã–µ –ø–æ –≤—Å–µ–º –º–µ—Ç–µ–æ—Å—Ç–∞–Ω—Ü–∏—è–º + –æ—Å—Ä–µ–¥–Ω–µ–Ω–Ω—ã–µ",
        "> ",
        "seven_station <- rbind(all_station, average_temp_by_7_station)",
        "> ",
        "> ",
        "> ",
        "# –¥–∞–Ω–Ω—ã–µ –æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞—Ö —Å–Ω–µ–≥–∞ –ø–æ 6 —Å—Ç–∞–Ω—Ü–∏—è–º (–∫—Ä–æ–º–µ –ë–∞—Ö—Ç—ã)",
        "> ",
        "snow_quality_six_station <- six_station_2005_2023 |> ",
        "+ ",
        "  select(-Tavg) |> ",
        "+ ",
        "  rename(Sn_description = Sn)",
        "> ",
        "> ",
        "write_csv2(snow_quality_six_station, \"initial_data/climate/cleaned/snow_quality_six_station.csv\")",
        "> ",
        "> ",
        "rm(all_station, average_temp_by_7_station, bakhta_monthly, four_station_obninsk, six_station,",
        "+ ",
        "   six_station_2005_2023,    six_station_2005_2023_monthly, vorogovo, yartsevo)",
        "> ",
        "> ",
        "# –†–∞—Å—á–µ—Ç –∞–Ω–æ–º–∞–ª–∏–π, —Å—Ä–µ–¥–Ω–µ–≥–æ –±–∞–∑–æ–≤–æ–≥–æ –∏ —Ç–¥ ---------------------------------",
        "> ",
        "# –û—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ --------------------------------------------------------------",
        "> ",
        "annualy_T_avg_Pr <- seven_station |> ",
        "+ ",
        "  rename(T_=Tavg) |> # –Ω–µ –º–µ–Ω—è—Ç—å, –∏–Ω–∞—á–µ –Ω–µ –±—É–¥—É—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è SE",
        "+ ",
        "  group_by(Station, Year) |> ",
        "+ ",
        "  summarise(Tavg = mean(T_),",
        "+ ",
        "            Tavg_SE = std(T_),",
        "+ ",
        "            Pr = sum(Pr)) # SE –¥–ª—è Pr –Ω–µ —Å—á–∏—Ç–∞–µ–º, —Ç–∞–∫ –∫–∞–∫ —Ç–∞–º –Ω–µ —Å—Ä–µ–¥–Ω–µ–µ, –∞ —Å—É–º–º–∞",
        "> ",
        "> ",
        "#–î–ª—è —Å–Ω–µ–∂–Ω–æ–≥–æ –ø–æ–∫—Ä–æ–≤–∞ —Å–¥–µ–ª–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ–¥–æ–≤–æ–≥–æ, –Ω–µ —É—á–∏—Ç—ã–≤–∞—è –ª–µ—Ç–Ω–∏–µ –º–µ—Å—è—Ü—ã",
        "> ",
        "annualy_Sn <- seven_station |> ",
        "+ ",
        "  rename(Sn_=Sn) |> # –Ω–µ –º–µ–Ω—è—Ç—å, –∏–Ω–∞—á–µ –Ω–µ –±—É–¥—É—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è SE",
        "+ ",
        "  filter(Month %in% c(1:5,9:12)) |> ",
        "+ ",
        "  group_by(Station, Year) |> ",
        "+ ",
        "  summarise(Sn = mean(Sn_),",
        "+ ",
        "            Sn_SE = std(Sn_))",
        "> ",
        "> ",
        "annualy <- annualy_T_avg_Pr |> ",
        "+ ",
        "  left_join(annualy_Sn, by = c(\"Station\", \"Year\"))",
        "> ",
        "> ",
        "rm(annualy_Sn, annualy_T_avg_Pr, six_station_monthly, Bakhta_monthly, tavg_by_seven_station)",
        "> ",
        "> ",
        "> ",
        "# –†–∞—Å—á–µ—Ç –±–∞–∑–æ–≤—ã—Ö (–æ–ø–æ—Ä–Ω—ã—Ö) –∑–Ω–∞—á–µ–Ω–∏–π ---------------------------------------",
        "> ",
        "base_annualy <- annualy |> ",
        "+ ",
        "  filter(Year %in% c(1961:1990)) |> ",
        "+ ",
        "  group_by(Station) |> ",
        "+ ",
        "  summarise(across(c(Tavg, Sn, Pr), list(",
        "+ ",
        "    base = mean,",
        "+ ",
        "    base_SE = std",
        "+ ",
        "  )))",
        "> ",
        "> ",
        "base_monthly <- seven_station |> ",
        "+ ",
        "  filter(Year %in% c(1961:1990)) |> ",
        "+ ",
        "  group_by(Station, Month) |> ",
        "+ ",
        "  summarise(across(c(Tavg, Sn, Pr), list(",
        "+ ",
        "    base = mean,",
        "+ ",
        "    base_SE = std",
        "+ ",
        "  )))",
        "> ",
        "> ",
        "# –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –¥–µ—Å—è—Ç–∏–ª–µ—Ç–∏–µ -------------------------------",
        "> ",
        "> ",
        "last_decade_annualy <- annualy |> ",
        "+ ",
        "  filter(Year %in% c(2013:2022)) |>  #2023 –≥–æ–¥ –Ω–µ –±–µ—Ä–µ–º, —Ç–∞–∫ –∫–∞–∫ –Ω–µ—Ç –ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö",
        "+ ",
        "  group_by(Station) |> ",
        "+ ",
        "  summarise(across(c(Tavg, Sn, Pr), list(",
        "+ ",
        "    last_decade = mean,",
        "+ ",
        "    last_decade_SE = std",
        "+ ",
        "  )))",
        "> ",
        "> ",
        "last_decade_monthly <- seven_station |> ",
        "+ ",
        "  filter(Year %in% c(2013:2022)) |> ",
        "+ ",
        "  group_by(Station, Month) |>",
        "+ ",
        "  summarise(across(c(Tavg, Sn, Pr), list(",
        "+ ",
        "    last_decade = mean,",
        "+ ",
        "    last_decade_SE = std",
        "+ ",
        "  )))",
        "> ",
        "> ",
        "# –†–∞—Å—á–µ—Ç –∞–Ω–æ–º–∞–ª–∏–π, —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ, –ª–∏–Ω–µ–π–Ω–æ–≥–æ —Ç—Ä–µ–Ω–¥–∞ —Å 1976 –≥–æ–¥–∞ –∏ —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É –±–∞–∑–æ–≤–æ–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–º –¥–µ—Å—è—Ç–∏–ª–µ—Ç–∏–µ–º --------",
        "> ",
        "annualy_anomaly <- annualy |> ",
        "+ ",
        "  left_join(base_annualy, by = \"Station\") |> ",
        "+ ",
        "  group_by(Station) |> ",
        "+ ",
        "  mutate(T_anomaly = Tavg-Tavg_base,",
        "+ ",
        "         Sn_anomaly = Sn-Sn_base,",
        "+ ",
        "         Pr_anomaly = Pr-Pr_base) |> ",
        "+ ",
        "  left_join(last_decade_annualy, by = \"Station\") |> ",
        "+ ",
        "  mutate(T_diff = Tavg_last_decade-Tavg_base,",
        "+ ",
        "         Sn_diff = Sn_last_decade-Sn_base,",
        "+ ",
        "         Pr_diff = Pr_last_decade-Pr_base) |> ",
        "+ ",
        "  mutate(across(c(T_anomaly, Pr_anomaly, Sn_anomaly, Tavg, Pr, Sn), list(",
        "+ ",
        "    roll_mean = means_smooth",
        "+ ",
        "  ))) |>",
        "+ ",
        "  mutate(across(contains(\"roll_mean\"),",
        "+ ",
        "                list(from_1976 = \\(x) c(rep(NA, 15), x[16:length(x)])",
        "+ ",
        "                )))",
        "> ",
        "> ",
        "monthly_anomaly <- seven_station |> ",
        "+ ",
        "  left_join(base_monthly, by = c(\"Station\", \"Month\")) |> ",
        "+ ",
        "  group_by(Station, Month) |> ",
        "+ ",
        "  mutate(T_anomaly=Tavg-Tavg_base,",
        "+ ",
        "         Sn_anomaly=Sn-Sn_base,",
        "+ ",
        "         Pr_anomaly=Pr-Pr_base) |> ",
        "+ ",
        "  left_join(last_decade_monthly, by=c(\"Station\",\"Month\"))|> ",
        "+ ",
        "  mutate(T_diff = Tavg_last_decade-Tavg_base,",
        "+ ",
        "         Sn_diff = Sn_last_decade-Sn_base,",
        "+ ",
        "         Pr_diff = Pr_last_decade-Pr_base) |> ",
        "+ ",
        "  mutate(across(c(T_anomaly, Pr_anomaly, Sn_anomaly, Tavg, Pr, Sn), list(",
        "+ ",
        "    roll_mean = means_smooth",
        "+ ",
        "  ))) |>",
        "+ ",
        "  mutate(across(contains(\"roll_mean\"),",
        "+ ",
        "                list(from_1976 = \\(x) c(rep(NA, 15), x[16:length(x)])",
        "+ ",
        "                )))",
        "> ",
        "> ",
        "write_csv2(annualy_anomaly, \"initial_data/climate/cleaned/annualy_anomaly.csv\")",
        "> ",
        "write_csv2(monthly_anomaly, \"initial_data/climate/cleaned/monthly_anomaly.csv\")",
        "> ",
        "> ",
        "> ",
        "> ",
        "\nRestarting R session...\n\n",
        "> ",
        "#| label: –ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞–∫–µ—Ç–æ–≤",
        "> ",
        "#| warning: false",
        "> ",
        "library(tidyverse)",
        "> ",
        "library(readxl)",
        "> ",
        "#| label: –§—É–Ω–∫—Ü–∏–∏",
        "> ",
        "#| warning: false",
        "> ",
        "> ",
        "> ",
        "bad_snow_count <- function(df, quality){",
        "+ ",
        "  # —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å —Å–µ–Ω—Ç—è–±—Ä—è –ø–æ –¥–µ–∫–∞–±—Ä—å. –ì–æ–¥ –ø—Ä–∏–±–∞–≤–ª—è–µ—Ç +1, —Ç–∞–∫ –∫–∞–∫ –≤–ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–∏ —ç—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±—É–¥–µ—Ç —Å—É–º–º–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å –¥–∞–Ω–Ω—ã–º–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ –≥–æ–¥–∞ (–∑–∏–º–Ω–∏–π –ø–µ—Ä–∏–æ–¥ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–æ—à–ª—ã–π –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏–π –≥–æ–¥—ã)",
        "+ ",
        "  sep_dec <- df |> ",
        "+ ",
        "    filter(Month %in% c(9:12), Sn_description %in% quality) |> ",
        "+ ",
        "    group_by(Year, Station) |> ",
        "+ ",
        "    summarise(N = n()) |> ",
        "+ ",
        "    mutate(Year =Year+1)",
        "+ ",
        "  # –¥–∞–Ω–Ω—ã–µ —Å —è–Ω–≤–∞—Ä—è –ø–æ –º–∞–π",
        "+ ",
        "  jan_may <- df |> ",
        "+ ",
        "    filter(Month %in% c(1:5), Sn_description %in% quality) |> ",
        "+ ",
        "    group_by(Year, Station) |> ",
        "+ ",
        "    summarise(N = n())",
        "+ ",
        "  ",
        "+ ",
        "  # –î–∂–æ–π–Ω —Ç–∞–±–ª–∏—Ü, –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –Ω—É–ª—è–º–∏, —Ä–∞—Å—á–µ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –Ω–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã—Ö –¥–Ω–µ–π –∑–∞ –≤—Å—é –∑–∏–º—É",
        "+ ",
        "  ",
        "+ ",
        "  total <-  sep_dec |> ",
        "+ ",
        "    full_join(jan_may, by = c(\"Year\", \"Station\")) |> ",
        "+ ",
        "    mutate(N.x=ifelse(is.na(N.x),0, N.x)) |> ",
        "+ ",
        "    mutate(N.y=ifelse(is.na(N.y),0, N.y)) |> ",
        "+ ",
        "    mutate(count = (N.x+N.y)) |> ",
        "+ ",
        "    rename(First_half = N.x, Last_half = N.y)",
        "+ ",
        "  ",
        "+ ",
        "  return(total)",
        "+ ",
        "  ",
        "+ ",
        "}",
        "> ",
        "#| label: –ò–º–ø–æ—Ä—Ç",
        "> ",
        "#| warning: false",
        "> ",
        "> ",
        "# Import ------------------------------------------------------------------",
        "> ",
        "snow_quality_data <- read_csv2(\"initial_data/climate/cleaned/Bakhta_daily_problem_with_summer_1966-1976.csv\") |> ",
        "+ ",
        "  select(Year, Month, Day, Tavg, Sn_description)",
        "> ",
        "> ",
        "# 2005 - 2023 -------------------------------------------------------------",
        "> ",
        "snow_quality_2005_2023 <- snow_quality_data |> ",
        "+ ",
        "  filter(Year > 2005 | (Year == 2005 & Month >1))",
        "> ",
        "> ",
        "> ",
        "levels(as.factor(snow_quality_data$Sn_description))",
        " [1] \"0\"                                                                                                                                                                                                                        \n [2] \"1\"                                                                                                                                                                                                                        \n [3] \"10\"                                                     ",
        "                                                                                                                                                                  \n [4] \"2\"                                                                                                                                                                                                                        \n [5] \"3\"                                                                                                                    ",
        "                                                                                                    \n [6] \"4\"                                                                                                                                                                                                                        \n [7] \"5\"                                                                                                                                                                                  ",
        "                                      \n [8] \"6\"                                                                                                                                                                                                                        \n [9] \"7\"                                                                                                                                                                                                                        \n[10] \"8\"               ",
        "                                                                                                                                                                                                         \n[11] \"9\"                                                                                                                                                                                                                        \n[12] \"99\"                                                                            ",
        "                                                                                                                                           \n[13] \"–ù–µ—Ä–æ–≤–Ω—ã–π —Å–ª–æ–π —Å–ª–µ–∂–∞–≤—à–µ–≥–æ—Å—è –∏–ª–∏ –º–æ–∫—Ä–æ–≥–æ —Å–Ω–µ–≥–∞ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—á–≤—É –ø–æ–ª–Ω–æ—Å—Ç—å—é.\"                                                                                                                                                  \n[14] \"–ù–µ—Ä–æ–≤–Ω—ã–π —Å–ª–æ–π —Å–ª–µ–∂–∞–≤—à–µ–≥–æ—Å—è –∏–ª–∏ –º–æ–∫—Ä–æ–≥–æ —Å–Ω–µ",
        "–≥–∞ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—á–≤—É –ø–æ–ª–Ω–æ—Å—Ç—å—é., –†–æ–≤–Ω—ã–π —Å–ª–æ–π —Å—É—Ö–æ–≥–æ —Ä–∞—Å—Å—ã–ø—á–∞—Ç–æ–≥–æ —Å–Ω–µ–≥–∞ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é.\"                                                                    \n[15] \"–ù–µ—Ä–æ–≤–Ω—ã–π —Å–ª–æ–π —Å—É—Ö–æ–≥–æ —Ä–∞—Å—Å—ã–ø—á–∞—Ç–æ–≥–æ —Å–Ω–µ–≥–∞ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é.\"                                                                                         ",
        "                                                  \n[16] \"–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –ø–æ–∫—Ä—ã—Ç–∞ –ª—å–¥–æ–º.\"                                                                                                                                                                         \n[17] \"–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –ø–æ–∫—Ä—ã—Ç–∞ –ª—å–¥–æ–º., –†–æ–≤–Ω—ã–π —Å–ª–æ–π —Å—É—Ö–æ–≥–æ —Ä–∞—Å—Å—ã–ø—á–∞—Ç–æ–≥–æ —Å–Ω–µ–≥–∞ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –ø–æ",
        "–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é.\"                                                                                           \n[18] \"–†–æ–≤–Ω—ã–π —Å–ª–æ–π —Å–ª–µ–∂–∞–≤—à–µ–≥–æ—Å—è –∏–ª–∏ –º–æ–∫—Ä–æ–≥–æ —Å–Ω–µ–≥–∞ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é.\"                                                                                                                                        \n[19] \"–†–æ–≤–Ω—ã–π —Å–ª–æ–π —Å—É—Ö–æ–≥–æ —Ä–∞—Å—Å—ã–ø—á–∞—Ç–æ–≥–æ —Å–Ω–µ–≥",
        "–∞ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é.\"                                                                                                                                             \n[20] \"–°–ª–µ–∂–∞–≤—à–∏–π—Å—è –∏–ª–∏ –º–æ–∫—Ä—ã–π —Å–Ω–µ–≥ (—Å–æ –ª—å–¥–æ–º –∏–ª–∏ –±–µ–∑ –Ω–µ–≥–æ), –ø–æ–∫—Ä—ã–≤–∞—é—â–∏–π –º–µ–Ω–µ–µ –ø–æ–ª–æ–≤–∏–Ω—ã –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –ø–æ—á–≤—ã.\"                                                                                                            ",
        "           \n[21] \"–°–ª–µ–∂–∞–≤—à–∏–π—Å—è –∏–ª–∏ –º–æ–∫—Ä—ã–π —Å–Ω–µ–≥ (—Å–æ –ª—å–¥–æ–º –∏–ª–∏ –±–µ–∑ –Ω–µ–≥–æ), –ø–æ–∫—Ä—ã–≤–∞—é—â–∏–π –ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ –ø–æ–ª–æ–≤–∏–Ω—É –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –ø–æ—á–≤—ã, –Ω–æ –ø–æ—á–≤–∞ –Ω–µ –ø–æ–∫—Ä—ã—Ç–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é.\"                                                                              \n[22] \"–°–ª–µ–∂–∞–≤—à–∏–π—Å—è –∏–ª–∏ –º–æ–∫—Ä—ã–π —Å–Ω–µ–≥ (—Å–æ –ª—å–¥–æ–º –∏–ª–∏ –±–µ–∑ –Ω–µ–≥–æ), –ø–æ–∫—Ä—ã–≤–∞—é—â–∏–π –ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ –ø–æ–ª–æ–",
        "≤–∏–Ω—É –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –ø–æ—á–≤—ã, –Ω–æ –ø–æ—á–≤–∞ –Ω–µ –ø–æ–∫—Ä—ã—Ç–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é., –†–æ–≤–Ω—ã–π —Å–ª–æ–π —Å—É—Ö–æ–≥–æ —Ä–∞—Å—Å—ã–ø—á–∞—Ç–æ–≥–æ —Å–Ω–µ–≥–∞ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é.\"\n[23] \"–°–Ω–µ–≥ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é; –≥–ª—É–±–æ–∫–∏–µ —Å—É–≥—Ä–æ–±—ã., –†–æ–≤–Ω—ã–π —Å–ª–æ–π —Å—É—Ö–æ–≥–æ —Ä–∞—Å—Å—ã–ø—á–∞—Ç–æ–≥–æ —Å–Ω–µ–≥–∞ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é.\" ",
        "                                                                             \n",
        "> ",
        "#| warning: false",
        "> ",
        "s <- levels(as.factor(snow_quality_data$Sn_description))[c(16,20,17)] # –û—Ç–±–æ—Ä —É—Ä–æ–≤–Ω–µ–π —Ñ–∞–∫—Ç–æ—Ä–∞, –∫–æ–≥–¥–∞ —Å–Ω–µ–≥ = –ª–µ–¥, –∏–ª–∏ —Å–Ω–µ–≥ –Ω–µ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –≤—Å—é –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã",
        "> ",
        "> ",
        "snow_quality_2005_2023 <- snow_quality_2005_2023 |> ",
        "+ ",
        "  mutate(Sn_description = ifelse(Sn_description %in% s,1,0)) |>  # 1 - –µ—Å–ª–∏ —Å–Ω–µ–≥ \"–ø–ª–æ—Ö–æ–π\"",
        "+ ",
        "  select(Year, Month, Day,Tavg,  Sn_description) |> ",
        "+ ",
        "  mutate(Station = \"bakhta\")",
        "> ",
        "rm(s, snow_quality_data)",
        "> ",
        "#| warning: false",
        "> ",
        "> ",
        "> ",
        "> ",
        "bad_snow_bakhta <- rbind(bad_snow_count(snow_quality_1961_2004, quality = 1),",
        "+ ",
        "                         bad_snow_count(snow_quality_2005_2023, quality = 1)) |> ",
        "+ ",
        "  mutate(Station = \"bakhta\")",
        "–û—à–∏–±–∫–∞: –æ–±—ä–µ–∫—Ç 'snow_quality_1961_2004' –Ω–µ –Ω–∞–π–¥–µ–Ω\n",
        "\nRestarting R session...\n\n",
        "> ",
        "#| label: –ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞–∫–µ—Ç–æ–≤",
        "> ",
        "#| warning: false",
        "> ",
        "> ",
        "library(tidyverse)",
        "> ",
        "library(readxl)",
        "> ",
        "library(MuMIn)",
        "> ",
        "> ",
        "#| label: —Ñ—É–Ω–∫—Ü–∏–∏",
        "> ",
        "#| warning: false",
        "> ",
        "> ",
        "read_files  <- function(x){",
        "+ ",
        "  read_excel(x) |> ",
        "+ ",
        "    select(Local_time, Temp = T, Sn_description = `E'`, sss) |> ",
        "+ ",
        "    mutate(Local_time = as_datetime(Local_time, format = \"%d.%m.%Y %R\")) |> ",
        "+ ",
        "    mutate(Year = year(Local_time),",
        "+ ",
        "           Month = as.factor(month(Local_time)),",
        "+ ",
        "           Day = mday(Local_time)) |> ",
        "+ ",
        "    filter(is.na(Temp) == F) |> ",
        "+ ",
        "    mutate(",
        "+ ",
        "      more_then_zero = Temp > 0, # –ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–æ–ª–±–µ—Ü, –ø–∞—Ä–∞–º–µ—Ç—Ä –±–æ–ª—å—à–µ 0? (TRUE | FALSE)",
        "+ ",
        "      chng1 = cumsum(more_then_zero != lag(more_then_zero, def = first(more_then_zero)))",
        "+ ",
        "    ) |> ",
        "+ ",
        "    group_by(Year, Month, Day) |> ",
        "+ ",
        "    mutate(max_chng = max(chng1),",
        "+ ",
        "           min_chng = min(chng1),",
        "+ ",
        "           diff = max_chng-min_chng) |> ",
        "+ ",
        "    summarise(Sn = mean(sss, na.rm = T),",
        "+ ",
        "              Sn_description = as.factor(str_flatten(Sn_description, \", \", na.rm = T)),",
        "+ ",
        "              Tavg = mean(Temp, na.rm = T),",
        "+ ",
        "              diff = max(diff))",
        "+ ",
        "}",
        "> ",
        "> ",
        "daily_temp <- function(x){",
        "+ ",
        "  read_excel(x) |> ",
        "+ ",
        "    select(Local_time, Temp = T, Sn_description = `E'`, sss) |> ",
        "+ ",
        "    mutate(Local_time = as_datetime(Local_time, format = \"%d.%m.%Y %R\")) |> ",
        "+ ",
        "    mutate(Year = year(Local_time),",
        "+ ",
        "           Month = as.factor(month(Local_time)),",
        "+ ",
        "           Day = mday(Local_time)) |> ",
        "+ ",
        "    filter(is.na(Temp) == F)",
        "+ ",
        "}",
        "> ",
        "#| label: –ò–º–ø–æ—Ä—Ç",
        "> ",
        "#| warning: false",
        "> ",
        "> ",
        "> ",
        "paths <- list.files(\"initial_data/climate/2005_2023\", pattern = \"[.]xls$\", full.names = TRUE) # –ü—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–ª–∏ –≤—Å–µ —Ñ–∞–π–ª—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏",
        "> ",
        "> ",
        "total_2005_2023 <- paths |> ",
        "+ ",
        "  map_df(read_files)",
        "> ",
        "> ",
        "s <- levels(as.factor(total_2005_2023$Sn_description))[c(4, 5,6)] # –û—Ç–±–æ—Ä —É—Ä–æ–≤–Ω–µ–π —Ñ–∞–∫—Ç–æ—Ä–∞, –∫–æ–≥–¥–∞ —Å–Ω–µ–≥ = –ª–µ–¥, –∏–ª–∏ —Å–Ω–µ–≥ –Ω–µ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –≤—Å—é –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã",
        "> ",
        "> ",
        "> ",
        "total_2005_2023 <- total_2005_2023 |> ",
        "+ ",
        "  mutate(Sn_description = ifelse(Sn_description %in% s,1,0)) |> ",
        "+ ",
        "  mutate(Sn = case_when(is.na(Sn) ~ 0, .default = Sn))",
        "> ",
        "> ",
        "total_2005_2023",
        "–û—à–∏–±–∫–∞ –≤ loadNamespace(x) : –Ω–µ—Ç –ø–∞–∫–µ—Ç–∞ –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º ‚Äòreticulate‚Äô\n",
        "\nRestarting R session...\n\n"
    ]
}