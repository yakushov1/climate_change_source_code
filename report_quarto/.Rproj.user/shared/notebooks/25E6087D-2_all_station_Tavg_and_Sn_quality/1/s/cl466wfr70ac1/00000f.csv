"0","#| label: reading_XXI"
"0","#| warning: false"
"0",""
"0","reading_XXI <- function(name_of_df){"
"0","  result <- read_excel(name_of_df) |> "
"0","    select(1,2,28) |> "
"0","    rename(Local_time = 1) |> "
"0","    mutate(Local_time = as_datetime(Local_time, format=""%d.%m.%Y %R"")) |> "
"0","    mutate(Year = year(Local_time),"
"0","           Month = month(Local_time),"
"0","           Day = mday(Local_time)) |> "
"0","    rename(Sn = ""E'"","
"0","           Tavg = ""T"") |>"
"0","    group_by(Year, Month, Day) |> "
"0","    summarise(Sn = as.factor(str_flatten(Sn, "", "", na.rm = T)),"
"0","              Tavg = mean(Tavg, na.rm=T)) |> "
"0","    arrange(Year, Month, Day) |> "
"0","    mutate(Station = str_match(name_of_df, ""station/(.*?).xls"")[2])"
"0","  return(result)"
"0","}"
