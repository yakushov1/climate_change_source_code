---
title: "Анализ климатических изменений в долине Енисея (примерно от 60 до 67 параллели)"
---

Перед вами документация, описывающая проведенный анализ климатических изменений в долине Енисея.

![Вид на Енисей в его среднем течении](IMG_2668.JPG){fig-align="center"}

Это расчеты по первой задаче из диссертации на соискание ученой степени кандидата биологических наук.

Пошагово действия описаны в разделах, перейти в которые можно с помощью ссылок в боковом меню.

Отчет создан с помощью системы Quarto в среде RStudio. Исходный код проекта, а также все входные данные доступны в отдельном репозитории.

Расчеты по остальным задачам из диссертации приведены в отдельных репозиториях.

*Краткое описание выполенных действий:*

Для расчета климатических норм и отклонений от них данные были осреднены до месячного разрешения. В качестве опорного был использован период 1961-1990 гг.

Климатические сезоны были выделены по устойчивому переходу среднесуточных температур через 0^0^С. С момента первого перехода температур из положительных в отрицательные начиналась климатическая «осень». После первого подобного явления среднесуточная температура могла возвратиться к положительным значениям, но с того дня, когда температура постоянно была отрицательной, выделялась климатическая «зима». Напротив, после первой положительной среднесуточной температуры наступала «весна», и после ее устойчивого перехода в положительные – «лето».

Линейные тренды среднегодовых, среднемесячных и среднесезонных климатических показателей были рассчитаны для сглаженных простым 10-ти летним скользящим средним временных рядов с 1976 по 2023 год.

Была также проанализирована степень покрытия почвы снегом: для 6 из 7 выбранных метеостанций с 2005 по 2023 год (данные с 1961 года отсутствуют в открытом доступе), для метеостанции п. Бахта – с 1961 по 2023 годы. Исходные данные с 2005 по 2023 гг. включали в себя 8 градаций данного фактора:

1.              Снег покрывает поверхность почвы полностью; глубокие сугробы.

2.              Ровный слой сухого рассыпчатого снега покрывает поверхность почвы полностью.

3.              Неровный слой сухого рассыпчатого снега покрывает поверхность почвы полностью.

4.              Неровный слой слежавшегося или мокрого снега покрывает почву полностью.

5.              Ровный слой слежавшегося или мокрого снега покрывает поверхность почвы полностью.

6.              Слежавшийся или мокрый снег (со льдом или без него), покрывающий по крайней мере половину поверхности почвы, но почва не покрыта полностью.

7.              Слежавшийся или мокрый снег (со льдом или без него), покрывающий менее половины поверхности почвы.

8.              Поверхность почвы преимущественно покрыта льдом.

Из перечисленных выше градаций наихудшее воздействие на мелких млекопитающих могли оказать в первую очередь 6, 7 и 8, именно они и были отобраны для последующего анализа. Чаще всего встречалась градация 7, поэтому в дальнейшем этот фактор упоминается как «количество дней, когда снег покрывал менее половины поверхности почвы». В первую очередь такие условия отмечались при незначительной глубине снежного покрова и температурах, близких к 0^0^С

Степень покрытия почвы снегом с 1961 по 2005 гг. была представлена в 10-ти балльной шкале от 1 (10% поверхности почвы покрыто снегом) до 10 (100% поверхности почвы покрыто снегом). Дни, когда снежный покров отсутствовал или не был измерен, имел пометку 99, такие дни были исключены из расчетов.

Чтобы согласовать данные за 2005-2023 гг. с данными за 1961-2004 гг., все градации данного фактора были заменены на две: 1 – снег покрывал менее половины поверхности почвы и 0 – снег покрывал более половины поверхности почвы.

Корректность такого разделения была проверена с помощью модели градиентного бустинга, реализованной на языке Python с помощью библиотек Catboost (Prokhorenkova et al., 2018) и Scikit-learn (Pedregosa et al., 2011). Данные за 2005-2023 годы использовались для обучения модели и ее валидации, а за 1961-2005 – в качестве тестового набора. Зависимая переменная – степень покрытия почвы снегом, предикторы – среднесуточные температура, количество осадков, глубина снежного покрова. Параметры модели: скорость обучения (learning rate) = 0.3 (этот параметр контролирует размер шага на каждой итерации, приближаясь к минимуму функционала качества), максимальное количество итераций = 200, при этом обучение было остановлено на 41 итерации для того, чтобы избежать переподгонки (overfitting) модели. Для оценки качества модели использовалась AUC – площадь под ROC-кривой. Чем ближе значение AUC к 1, тем выше качество модели. Кривая ROC – это график, который иллюстрирует производительность классификационной модели при всех возможных порогах классификации. Ось X данного графика представляет собой FPR (false positive rate), т.е ложноположительную частоту, а ось Y — TPR (true positive rate), т.е истинноположительную частоту. TPR также известен как Recall, и определяется как доля правильно классифицированных положительных результатов относительно всех положительных результатов в данных. FPR определяет долю ошибочно классифицированных отрицательных результатов относительно всех отрицательных результатов.

Полученная модель показала высокое качество как на валидационной (AUC=0.97), так и на тестовой выборке (AUC=0.96), что подтверждает согласованность данных, полученных из разных источников, между собой (рисунок 6). В дальнейших расчетах использовались только те дни, когда снег покрывал менее половины поверхности почвы.

Кроме того, было рассчитано количество циклов «замерзание-оттаивание» в течение месяца по данным суточного разрешения, то есть переход температур через 0^0^С. Такие погодные явления могли привести к образованию ледяной корки на поверхности снега или почвы.

Все описанные выше расчеты были выполнены в основном с помощью самостоятельно написанных функций с опорой на пакеты tidyr, dplyr (Wickham, Girlich, 2022), purr (Mailund, 2022).
